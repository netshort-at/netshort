<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>netshort.at ‚Äì √ñsterreichische Netto-Short-Positionen</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      line-height: 1.6;
      padding: 0 20px;
      background-color: #f9f9f9;
    }
    h1, h2 {
      color: #2c3e50;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #34495e;
    }
    th, td {
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #34495e;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #ecf0f1;
    }
    .table-container {
      overflow-x:auto;
    }
    canvas {
      margin-top: 40px;
      max-width: 100%;
    }
  </style>
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>netshort.at</h1>

  <p>Privates, nicht-kommerzielles Projekt im Aufbau.</p>
  <p>Ziel ist die √ºbersichtliche Darstellung √∂sterreichischer Netto-Short-Positionen auf Basis √∂ffentlich zug√§nglicher FMA-Daten.</p>
  <p>‚ö†Ô∏è Keine Anlageberatung. Datenquelle: FMA.</p>
  <p>üöß Entwicklung l√§uft ‚Äì Inhalte folgen.</p>

  <section id="table">
    <h2>Live-Tabelle ‚Äì Netto-Short-Positionen</h2>
    <div class="table-container">
      <table id="shortTable">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>

  <section id="charts">
    <h2>Historische Zeitreihen (Beispiel)</h2>
    <canvas id="shortChart"></canvas>
  </section>

<script>
  // ===== Embedded CSV =====
  const csvText = `Position Holder,Issuer,ISIN Code,Position Date,Net Short Position (%),Reporting Date,Cancellation Date
Beispiel Holder 1,Testfirma A,AT0000XXX,2026-01-01,2.5,2026-01-02,-
Beispiel Holder 2,Testfirma B,AT0000YYY,2026-01-02,1.8,2026-01-03,-
Beispiel Holder 3,Testfirma C,AT0000ZZZ,2026-01-03,3.2,2026-01-04,-`;

  const lines = csvText.trim().split('\n');
  const headers = lines[0].split(',');
  const rows = lines.slice(1);

  // ===== Tabelle f√ºllen =====
  const table = document.getElementById('shortTable');
  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');

  // Tabellenkopf
  const headerRow = document.createElement('tr');
  headers.forEach(h => {
    const th = document.createElement('th');
    th.textContent = h;
    headerRow.appendChild(th);
  });
  thead.appendChild(headerRow);

  // Tabellenzeilen
  rows.forEach(line => {
    const cols = line.split(',');
    const tr = document.createElement('tr');
    cols.forEach(col => {
      const td = document.createElement('td');
      td.textContent = col;
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });

  // ===== Chart.js vorbereiten =====
  const chartLabels = rows.map(r => r.split(',')[3]); // Position Date
  const chartData = rows.map(r => parseFloat(r.split(',')[4])); // Net Short Position (%)
  const chartHolders = rows.map(r => r.split(',')[0]); // Holder

  const ctx = document.getElementById('shortChart').getContext('2d');
  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: chartLabels,
      datasets: [{
        label: 'Netto-Short Position (%)',
        data: chartData,
        backgroundColor: 'rgba(52, 152, 219, 0.6)',
        borderColor: 'rgba(52, 152, 219, 1)',
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'Netto-Short Position (%)' } },
        x: { title: { display: true, text: 'Datum' } }
      }
    }
  });
</script>

</body>
</html>
